<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			.div1 {width: 100px; height: 100px;background: red;filter:alpha(opacity:30); opacity:0.3;}
		</style>
		<script type="text/javascript">
			
			window.onload=function(){
				
				var oDiv=document.getElementsByClassName('div1')[0];
				var oBtn=document.getElementById('obtn');
				oBtn.onclick=function(){
					startMove(oDiv,{width: 201, height: 300, opacity: 100},function(){alert("运动完成了")});
				}
			}
			function getStyle(obj,attr){
				
				if(obj.currentStyle){
					return obj.currentStyle[attr];
				}
				else
				{
					return getComputedStyle(obj,[])[attr];
				}
				
			}
			function startMove(obj,json,fnEnd){
				
				clearInterval(obj.timer);
				
				obj.timer=setInterval(function(){
					
					var bStop=true;
					
					for(var attr in json){
						
						var cur=0;
						
						if(attr=='opacity'){
							
							cur=Math.round(parseFloat(getStyle(obj,attr))*100)
						}
						else
						{
							cur=parseInt(getStyle(obj,attr));
						}
						
						var speed=(json[attr]-cur)/6;
						
						speed=speed>0?Math.ceil(speed):Math.floor(speed);
						
						
						if(attr=='opacity')
						{
							obj.style.filter='alpha(opacity:'+(cur+speed)+')';
							obj.style.opacity=(cur+speed)/100;
						}
						else{
							obj.style[attr]=cur+speed+'px';
						}
						
						if(cur!=json[attr])
							bStop = false;
						
						
					}
					if(bStop){
						clearInterval(obj.timer);
						if(fnEnd)fnEnd();
					}
									
				},30);
			}
		</script>
	</head>
	<body>
		<input type="button" name="obtn" id="obtn" value="改变" />
		<div class="div1"></div>
	</body>
</html>
